<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Groupes d'utilisateurs cabinet -->
    <record id="group_cabinet_user" model="res.groups">
        <field name="name">Cabinet User</field>
        <field name="category_id" ref="base.module_category_accounting_accounting"/>
        <field name="comment">Utilisateurs cabinet - Accès lecture seule</field>
    </record>

    <record id="group_cabinet_accountant" model="res.groups">
        <field name="name">Cabinet Accountant</field>
        <field name="category_id" ref="base.module_category_accounting_accounting"/>
        <field name="implied_ids" eval="[(4, ref('group_cabinet_user'))]"/>
        <field name="comment">Comptables cabinet - Gestion clients et validations</field>
    </record>

    <record id="group_cabinet_manager" model="res.groups">
        <field name="name">Cabinet Manager</field>
        <field name="category_id" ref="base.module_category_accounting_accounting"/>
        <field name="implied_ids" eval="[(4, ref('group_cabinet_accountant'))]"/>
        <field name="comment">Expert-comptable / Manager - Accès complet</field>
    </record>

    <!-- Règles d'accès multi-company -->
    <record id="cabinet_client_multi_company_rule" model="ir.rule">
        <field name="name">Cabinet Client Multi-Company</field>
        <field name="model_id" ref="base.model_res_partner"/>
        <field name="domain_force">[('cabinet_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('group_cabinet_user'))]"/>
    </record>

    <record id="cabinet_task_multi_company_rule" model="ir.rule">
        <field name="name">Cabinet Task Multi-Company</field>
        <field name="model_id" ref="model_cabinet_task"/>
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('group_cabinet_user'))]"/>
    </record>

    <record id="cabinet_dashboard_multi_company_rule" model="ir.rule">
        <field name="name">Cabinet Dashboard Multi-Company</field>
        <field name="model_id" ref="model_cabinet_dashboard"/>
        <field name="domain_force">[('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('group_cabinet_user'))]"/>
    </record>
</odoo>
